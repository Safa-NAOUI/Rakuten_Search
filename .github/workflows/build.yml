name: Build Android Project

on:
  push:
    branches:
      - main   # Déclenche le workflow sur chaque push vers la branche principale

jobs:
  build:
    runs-on: ubuntu-latest    # Exécuter sur Ubuntu

    steps:
      # Étape 1: Checkout du code source
      - name: Checkout code
        uses: actions/checkout@v2

      # Étape 2: Configurer Java (nécessaire pour la compilation Android)
      - name: Set up JDK 11
        uses: actions/setup-java@v2
        with:
          java-version: '11'    # Vous pouvez ajuster la version selon vos besoins

      # Étape 3: Créer google-services.json à partir du secret
      - name: Create google-services.json
        run: |
          echo "$GOOGLE_SERVICES_JSON" > app/google-services.json
        env:
          GOOGLE_SERVICES_JSON: ${{ secrets.GOOGLE_SERVICES_JSON }}  # Utilise le secret pour créer le fichier

      # Étape 4: Construire le projet Android
      - name: Build Android project
        run: ./gradlew assembleRelease  # Ajustez la commande en fonction de vos besoins (par exemple, assembleDebug)
